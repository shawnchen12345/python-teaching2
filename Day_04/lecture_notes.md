# Day 4: 面向对象编程 OOP (详细讲义)

**课程时长**: 4-5 小时
**教学目标**: 完成编程思维的转变，从“在面条代码中跳转”转变为“设计对象交互”。能够使用类、继承和多态构建清晰的系统。

---

## 第一部分：OOP 思想觉醒 (1 小时)

### 1.1 为什么需要 OOP？
*   **案例对比**:
    *   **过程式**: 写一个存钱逻辑。`user = {'name': 'A', 'bal': 100}`, `def withdraw(u, amt): ...`
    *   **对象式**: `user.withdraw(100)`。数据（余额）和操作（取钱）是封装在一起的，更安全，更符合直觉。

### 1.2 "Class" vs "Object"
*   **Class (类)**: 模具 / 图纸 (比如 "人类")。
*   **Object (对象/实例)**: 具体的产物 (比如 "张三", "李四")。

---

## 第二部分：类的定义与属性 (1 小时)

### 2.1 构造函数 (__init__)
对象的产生过程。`self` 是什么？
*   `self` 指代“当前正在创建的这个对象”。
*   `self.name = name`: 把传入的参数永久绑定到这个对象身上，成为**属性 (Attribute)**。

### 2.2 方法 (Method)
类里面的函数。
*   第一个参数永远是 `self`（调用时不需要传，Python 自动传）。
*   可以访问对象的内部状态 (`self.hp`).

### 2.3 类属性 vs 实例属性
```python
class Dog:
    species = "Canis" # 类属性 (所有狗共享)
    def __init__(self, name):
        self.name = name # 实例属性 (每只狗不同)
```

---

## 第三部分：OOP 三大支柱 (1.5 小时)

### 3.1 封装 (Encapsulation)
*   不要直接修改属性：`p.hp = -100` (不安全)。
*   应该通过方法修改：`p.take_damage(100)` -> 内部逻辑可以判断 `if hp < 0: hp = 0`。
*   **私有属性**: `self.__secret` (前面加两个下划线)，外部无法直接访问，保护数据。

### 3.2 继承 (Inheritance)
*   **DRY**: 战士(Warrior)和法师(Mage)都有名字和血量，都有移动方法。把这些提取到 `Hero` 父类中。
*   `class Child(Parent):`
*   **super()**: `super().__init__(name)` 在子类初始化时，别忘了先调用父类的初始化，通过父类完成基础设置。

### 3.3 多态 (Polymorphism)
让不同的对象对同一指令做出不同反应。
```python
def mass_attack(units):
    for u in units:
        u.attack() # 战士挥剑，法师丢火球，代码不用改
```

---

## 第四部分：实战 - 文字版 RPG 战斗引擎 (1.5 小时)

### 4.1 需求分析
设计一个微型游戏系统：
*   **Role**: 基类。属性: name, hp, atk. 方法: `is_alive`, `attack`.
*   **Warrior**: 只有普通攻击，但血厚。
*   **Mage**: 血脆，但有 `fire_ball` (高伤害，消耗 mp)。
*   **Healer**: 攻击极低，但有 `heal` (给队友加血)。

### 4.2 开发步骤
1.  先设计基类 `Role`，保证基础功能（扣血、死亡判断）正常。
2.  实现各职业子类。
3.  编写 `Game` 类来控制流程（回合制循环：Team A 行动 -> Team B 行动）。
4.  (选做) 增加随机暴击、闪避率。

### 4.3 代码重构体验
演示：如果我想增加一个“吸血鬼”职业，我只需要新建一个类继承 `Role` 即可，主程序的战斗逻辑完全不用动！这就是 OOP **可扩展性**的体现。
