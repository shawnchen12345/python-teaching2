# Day 4 课后作业 - 面向对象编程 (OOP)
# 请独立完成以下练习，然后对照 homework_answers.py 检查

"""
作业说明：
- 请认真阅读每道题的要求
- 尝试独立完成后再查看答案
- 如果遇到困难，可以参考 lecture.md 和 class_exercises_answers.py
- 重点关注：类的设计、封装、继承、多态的应用
"""

# ===========================================================
# 作业 1：图书管理系统 (基础)
# 难度：⭐⭐
# ===========================================================

print("=" * 50)
print("作业 1：图书管理系统")
print("=" * 50)

"""
设计一个简单的图书管理系统：

类 Book:
  - 属性: isbn (书号), title (书名), author (作者), available (是否可借, 默认True)
  - 方法: __str__() 返回 "《书名》 by 作者 [状态]"
         状态为 "可借" 或 "已借出"
  - 方法: borrow() 借书，如果可借则设为不可借并返回True，否则返回False
  - 方法: return_book() 还书，设为可借

类 Library:
  - 属性: name (图书馆名), books (图书列表)
  - 方法: add_book(book) 添加图书
  - 方法: remove_book(isbn) 根据ISBN移除图书
  - 方法: find_book(title) 根据书名查找图书（模糊匹配）
  - 方法: list_available() 列出所有可借图书
  - 方法: list_all() 列出所有图书

测试要求:
1. 创建一个图书馆，添加至少3本书
2. 借出一本书
3. 显示所有可借图书
4. 归还图书
5. 根据书名查找图书
"""

# [TODO] 在这里编写 Book 类


# [TODO] 在这里编写 Library 类


# [TODO] 在这里编写测试代码



# ===========================================================
# 作业 2：银行账户系统 (进阶)
# 难度：⭐⭐⭐
# ===========================================================

print("\n" + "=" * 50)
print("作业 2：银行账户系统")
print("=" * 50)

"""
设计一个银行账户系统，要求：

类 BankAccount (基类):
  - 私有属性: __balance (余额)
  - 公开属性: account_number (账号), owner (户主)
  - 方法: deposit(amount) 存款，金额必须>0
  - 方法: withdraw(amount) 取款，余额必须足够
  - 方法: get_balance() 获取余额
  - 方法: __str__() 返回账户信息

类 CheckingAccount (支票账户，继承 BankAccount):
  - 新增属性: overdraft_limit (透支额度，默认500)
  - 重写 withdraw(): 可以透支，但不能超过透支额度
    例如：余额100，透支额度500，最多可取600

类 SavingsAccount (储蓄账户，继承 BankAccount):
  - 新增属性: interest_rate (年利率，默认0.02)
  - 新增属性: withdrawal_limit (每月取款次数限制，默认3)
  - 新增属性: withdrawal_count (本月已取款次数)
  - 重写 withdraw(): 每月只能取款指定次数
  - 新增方法: add_interest() 添加利息
  - 新增方法: reset_withdrawal_count() 重置取款次数（模拟月初）

测试要求:
1. 创建不同类型的账户
2. 测试存款、取款功能
3. 测试支票账户的透支功能
4. 测试储蓄账户的取款限制和利息
"""

# [TODO] 在这里编写代码



# ===========================================================
# 作业 3：动物园模拟 (多态)
# 难度：⭐⭐⭐
# ===========================================================

print("\n" + "=" * 50)
print("作业 3：动物园模拟")
print("=" * 50)

"""
设计一个动物园系统：

类 Animal (基类):
  - 属性: name (名称), species (物种), age (年龄)
  - 方法: speak() 发出声音（基类返回 "..."）
  - 方法: eat(food) 吃东西，打印 "{name}正在吃{food}"
  - 方法: perform() 表演，打印 "{name}在表演"
  - 方法: __str__() 返回动物信息

类 Lion (继承 Animal):
  - 重写 speak(): 返回 "吼!" 或 "嗷呜~"
  - 重写 perform(): "威风凛凛地走过"

类 Elephant (继承 Animal):
  - 新增属性: trunk_length (象鼻长度)
  - 重写 speak(): 返回 "帕欧~"
  - 重写 perform(): "用鼻子喷水表演"

类 Monkey (继承 Animal):
  - 新增属性: favorite_fruit (最爱的水果)
  - 重写 speak(): 返回 "吱吱吱"
  - 重写 perform(): "表演倒挂金钩"
  - 重写 eat(): 如果food是最爱的水果，额外打印 "太好吃了！"

类 Zoo:
  - 属性: name (动物园名), animals (动物列表)
  - 方法: add_animal(animal) 添加动物
  - 方法: feed_all(food) 喂所有动物
  - 方法: perform_show() 让所有动物表演
  - 方法: roll_call() 点名：让所有动物叫一声

测试要求:
1. 创建一个动物园
2. 添加不同种类的动物
3. 举办表演
4. 喂食
5. 点名
"""

# [TODO] 在这里编写代码



# ===========================================================
# 作业 4：扩展 RPG 战斗系统 (综合挑战)
# 难度：⭐⭐⭐⭐
# ===========================================================

print("\n" + "=" * 50)
print("作业 4：扩展 RPG 战斗系统")
print("=" * 50)

"""
在讲义的 RPG 战斗系统基础上，扩展以下功能：

1. 新增职业 Assassin (刺客):
   - 较低的HP (90)，较高的ATK (30)
   - 特殊技能 backstab(): 
     - 30% 几率造成3倍暴击伤害
     - 70% 几率造成1.5倍普通伤害

2. 为所有角色添加闪避机制:
   - 在 take_damage() 中添加闪避判定
   - 基础闪避率 10%
   - Assassin 的闪避率提高到 25%

3. 新增状态效果:
   - 中毒 (Poison): 每回合损失5HP，持续3回合
   - Mage 的新技能 poison_cloud(): 消耗15MP，使目标中毒

4. 实现一个简单的回合制战斗:
   - 创建函数 battle(team_a, team_b)
   - 双方轮流行动（Team A 所有人行动 → Team B 所有人行动）
   - 自动选择攻击目标（随机选择存活的敌人）
   - 战斗持续到一方全灭
   - 返回胜利方

5. (选做) 添加经验值和升级系统:
   - 角色击杀敌人获得经验值
   - 经验值达到阈值时升级
   - 升级增加HP和ATK

提示:
- 可以使用 random 模块实现随机效果
- 状态效果可以用列表存储，每回合开始时处理
"""

import random

# [TODO] 在这里编写代码



# ===========================================================
# 作业 5：设计模式实践 - 单例模式 (选做/挑战)
# 难度：⭐⭐⭐⭐⭐
# ===========================================================

print("\n" + "=" * 50)
print("作业 5：单例模式（选做）")
print("=" * 50)

"""
学习并实现单例模式 (Singleton Pattern):

单例模式确保一个类只有一个实例。

应用场景：
- 数据库连接池
- 配置管理器
- 日志管理器

任务：
1. 实现一个 GameConfig 类，使用单例模式
   - 属性: difficulty (难度), sound_volume (音量), resolution (分辨率)
   - 无论创建多少次，都返回同一个实例

2. 实现一个 Logger 类，使用单例模式
   - 方法: log(message) 打印日志（带时间戳）
   - 方法: get_logs() 返回所有日志
   - 无论在哪里调用 Logger()，都是同一个实例

提示：可以使用 __new__ 方法或装饰器实现
"""

# [TODO] 在这里编写代码（选做）



print("\n" + "=" * 50)
print("作业完成后，请运行 homework_answers.py 对照答案")
print("=" * 50)
